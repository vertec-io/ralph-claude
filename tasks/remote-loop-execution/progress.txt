# Ralph Progress Log
Effort: remote-loop-execution
Type: Bug Investigation (Feasibility Study)
Started: 2026-01-23
Rotation: 1 (rotated at 2026-01-23 13:54)

## Codebase Patterns
- DUAL-MODE agent management: tmux for claude, opencode serve for opencode
- Claude: Sessions run in detached tmux sessions via libtmux (session.py)
- Claude: Tmux sessions use `remain-on-exit`, `tmux_session_alive()` checks `pane_dead_status`
- Claude: Attach is `tmux attach-session -t <name>`, stop uses signal files
- OpenCode: `opencode serve --port <auto>` starts headless HTTP server
- OpenCode: TUI via `opencode attach http://localhost:<port>` — native opencode experience
- OpenCode: Prompts sent via `POST /session/:id/message` (sync) or `prompt_async` (async)
- OpenCode: Completion detected via SSE events (`GET /event`) — `session.idle` event
- OpenCode: Stop via `POST /session/:id/abort`, health via `GET /global/health`
- OpenCode: Server stores sessions in `~/.opencode/data/storage/` (filesystem, not SQLite)
- OpenCode: Multiple clients can connect simultaneously (SSE broadcast)
- OpenCode: `OPENCODE_SERVER_PASSWORD` enables HTTP Basic Auth
- Session state tracked in SQLite at `~/.local/share/ralph/sessions.db`
- CLI uses Click, session management uses libtmux (not subprocess tmux calls)
- Progress file rotation preserves Codebase Patterns section across rotations
- For remote opencode: Ziti proxies the HTTP port, `opencode attach http://<ziti>:<port>` works
- For remote claude: proxy tmux socket over Ziti or SSH-over-Ziti tunnel
- OpenZiti Python SDK (v1.5.0): no native asyncio, but Ziti fds are epoll-compatible on Linux
- SDK supports multiple service binds per process from one ZitiContext
- Identity loaded via openziti.load(path) returning ZitiContext; one context can host N services


## Prior Progress
Completed 0 iterations in progress-1.txt.
_See progress-1.txt for detailed iteration logs._

---

---
CHECKPOINT at 2026-01-23 14:06
Iteration: 7/20 | Stories: 3/7 | Agent: opencode
Reason: shutdown signal
---
